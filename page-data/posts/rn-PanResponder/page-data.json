{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/rn-PanResponder/","webpackCompilationHash":"bba7c4862a862269a568","result":{"data":{"markdownRemark":{"id":"b79f323d-c538-5850-bc1f-764d78da5d96","html":"<p>이 번에 공부한 내용은 터치와 제스처 관련한 PanResponder이다.\n일반적인 앱을 구현할 때는 PanResponder 으로 터치 핸들링을 구현할 필요가 없다고 하지만,\n웹에서도 워낙 애니메이션, interactive 컴포넌트 구현에 관심이 많았기에 좀 더 열심히 파보기로 했다.</p>\n<p>소스코드는 <a href=\"https://github.com/Yeri-Kim/learning-react-native/blob/master/ch4/TouchGesture.tsx\">github</a>에 올려두었고,\n이번에도 typescript로 구현하였다.</p>\n<h3 id=\"panresponder\"><a href=\"#panresponder\" aria-label=\"panresponder permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PanResponder</h3>\n<p>PanResponder는 react-native에서 제공하는 클래스이며, 특정 제스처에 해당하는 handler를 세팅할 수 있다.\nhandler에는 native event와 gestureState 객체를 인자로 받는다.</p>\n<p>gestureState 객체를 통해 현재 제스처의 속도, 누적 이동거리 등과 같은 위치 데이터에 접근할 수 있다.\nPanResponder를 사용하기 위해서는 PanResponder객체를 생성하고 컴포넌트의 랜더 함수에 결합해야 한다.\n아래의 여섯가지 함수를 통해 터치 이벤트의 전체 라이프사이클에 접근할 수 있다.</p>\n<p>각 이벤트의 handler는 우측과 같으며 event, gestureState 인자를 받는다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">onPanResponderMove</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> gestureState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>나는 constructor에서 PanResponder을 생성해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_panResponder <span class=\"token operator\">=</span> PanResponder<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//아래 두가지는 주어진 터치 이벤트에 반응할지를 결정한다.</span>\n  onStartShouldSetPanResponder<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handleStartShouldSetPanResponder<span class=\"token punctuation\">,</span>\n  onMoveShouldSetPanResponder<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handleMoveShouldSetPanResponder<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//터치이벤트가 발생할 떄 실행</span>\n  onPanResponderGrant<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderGrant<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//터치이벤트가 진행중일 때 실행</span>\n  onPanResponderMove<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderMove<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">//아래 두개는 터치 이벤트가 끝날 때 실행</span>\n  onPanResponderRelease<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderEnd<span class=\"token punctuation\">,</span>\n  onPanResponderTerminate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderEnd\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>native event는 원래 native app touch 정보를 주는 것같고 <a href=\"https://facebook.github.io/react-native/docs/panresponder.html\">공식문서</a>에서 보는 것이 좋을 것 같다.\n<code class=\"language-text\">gestureState</code> 객체에는 아래와 같은 정보가 들어온다.</p>\n<ul>\n<li>stateID - 제스처 id</li>\n<li>moveX - 마지막(최신,latest)에 이동한 요소의 좌표</li>\n<li>moveY - 마지막(최신,latest)에 이동한 요소의 좌표</li>\n<li>x0 - 이동직전의 좌표. 즉 터치이벤트가 발생한 순간의 좌표인 것 같다.</li>\n<li>y0 - 이동직전의 좌표. 즉 터치이벤트가 발생한 순간의 좌표인 것 같다.</li>\n<li>dx - 터치가 시작된 이후 제스처의 누적(움직인) 거리</li>\n<li>dy - 터치가 시작된 이후 제스처의 누적(움직인) 거리</li>\n<li>vx - 제스처의 현재 속도</li>\n<li>vy - 제스처의 현재 속도</li>\n<li>numberActiveTouches: 현재 화면에 표시된 터치 수, 세손가락을 올리면 3이다.</li>\n</ul>\n<p><code class=\"language-text\">moveX, moveY</code>에 대해 알아두어야 할 것이 있다면, 이 좌표는 요소의 한가운데점 또는, 좌측상단의 좌표가 아니라!\n내가 터치하고 있는 그 점의 좌표이다.\n나는 요소의 가운데 점의 좌표인줄 알았는데 요소가 같은 위치에 있더라도 내가 어느 영역을 터치하는지에 따라 좌표가 달랐다.</p>\n<p>그리고, <code class=\"language-text\">x0 + dx = moveX</code>인듯 하다.</p>\n<p><code class=\"language-text\">vx, vy</code>는 정확한 단위는 모르겠지만, 우측/아래로 가면 +(vx/vy가 플러스)이다.</p>\n<img src=\"/media/190704.gif\" width=\"230\">\n<p>소스코드는 <a href=\"https://github.com/Yeri-Kim/learning-react-native/blob/master/ch4/TouchGesture.tsx\">github</a>에 올려두었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  StyleSheet<span class=\"token punctuation\">,</span>\n  Text<span class=\"token punctuation\">,</span>\n  View<span class=\"token punctuation\">,</span>\n  PanResponder\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-native'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CIRCLE_SIZE</span> <span class=\"token operator\">=</span> <span class=\"token number\">80</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CIRCLE_COLOR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CIRCLE_HIGHLIGHT_COLOR</span> <span class=\"token operator\">=</span> <span class=\"token string\">'green'</span><span class=\"token punctuation\">;</span>\n\ntype StateType <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  stateID<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> string<span class=\"token punctuation\">;</span>\n  numberActiveTouches<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  moveX<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  moveY<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  x0<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  y0<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  dx<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  dy<span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  vx<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n  vy<span class=\"token operator\">?</span><span class=\"token punctuation\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TouchGesture</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> StateType<span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n\n  _panResponder<span class=\"token punctuation\">:</span> any <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  _previousLeft <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  _previousTop <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  _circlesStyles <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    style<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      left<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n      top<span class=\"token punctuation\">:</span> <span class=\"token number\">500</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  circle <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      numberActiveTouches<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      moveX<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      moveY<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      x0<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      y0<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      dx<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n      dy<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//PanResponder gesture state 객체를 통해 현재 제스처의 속도, 누적 이동거리 등과 같은 원시 위치 데이터에 접근할 수 있다.</span>\n    <span class=\"token comment\">//PanResponder를 사용하기 위해서는 PanResponder객체를 생성하고 컴포넌트의 랜더 함수에 결합해야 한다.</span>\n    <span class=\"token comment\">//아래의 여섯가지 함수를 통해 터치 이벤트의 전체 라이프사이클에 접근할 수 있다.</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_panResponder <span class=\"token operator\">=</span> PanResponder<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//아래 두가지는 주어진 터체 이벤트에 반응할지를 결정한다.</span>\n      onStartShouldSetPanResponder<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handleStartShouldSetPanResponder<span class=\"token punctuation\">,</span>\n      onMoveShouldSetPanResponder<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handleMoveShouldSetPanResponder<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//터치이벤트가 발생할 떄 실행</span>\n      onPanResponderGrant<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderGrant<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//터치이벤트가 진행중일 때 실행</span>\n      onPanResponderMove<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderMove<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//아래 두개는 터치 이벤트가 끝날 때 실행</span>\n      onPanResponderRelease<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderEnd<span class=\"token punctuation\">,</span>\n      onPanResponderTerminate<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_handlePanResponderEnd\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_updatePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'render'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">View</span></span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">View</span></span>\n          <span class=\"token attr-name\">ref</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">circle</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle <span class=\"token operator\">=</span> circle<span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>circle<span class=\"token punctuation\">}</span></span>\n          <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">this</span><span class=\"token punctuation\">.</span><span class=\"token attr-value\">_panResponder</span><span class=\"token punctuation\">.</span><span class=\"token attr-value\">panHandlers</span><span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>numberActiveTouches<span class=\"token punctuation\">}</span><span class=\"token plain-text\"> touches\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          toucheId: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>stateID<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          moveX: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>moveX<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          moveY: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>moveY<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          dx: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>dx<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          dy: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>dy<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          x0: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>x0<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          y0: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>y0<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          vx: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>vx<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          vy: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>vy<span class=\"token punctuation\">}</span><span class=\"token plain-text\">,\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Text</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">View</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">_highlight</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_highlight'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle<span class=\"token punctuation\">.</span><span class=\"token function\">setNativeProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        style<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token constant\">CIRCLE_HIGHLIGHT_COLOR</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_unHighlight</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_unHighlight'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle<span class=\"token punctuation\">.</span><span class=\"token function\">setNativeProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        style<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token constant\">CIRCLE_COLOR</span> <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_updatePosition</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'=====_updatePosition====='</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>circle<span class=\"token punctuation\">.</span><span class=\"token function\">setNativeProps</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_circlesStyles<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_handleStartShouldSetPanResponder</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> gestureState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_handleStartShouldSetPanResponder'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 사용자가 원 부분을 누르기 시작할 때 responder 활성화 여부</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_handleMoveShouldSetPanResponder</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> gestureState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_handleMoveShouldSetPanResponder'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 사용자가 원 위로 터치하여 움직일 때 responder를 활성화할까요?</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_handlePanResponderGrant</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> gestureState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_handlePanResponderGrant'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//터치이벤트가 발생할 떄 실행</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_highlight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_handlePanResponderMove</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> gestureState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_handlePanResponderMove'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//터치이벤트가 진행중일 때 실행</span>\n    <span class=\"token comment\">//여기서 screen은 터치하고자 하는 요소(circle)을 의미한다</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">//gestureState id</span>\n      stateID<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>stateID<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//마지막(최신,latest) screen 최표</span>\n      <span class=\"token comment\">//이 좌표는 요소의 가운데 좌표가 아니라, 내가 터치하고 있는 좌표이다.</span>\n      moveX<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>moveX<span class=\"token punctuation\">,</span>\n      moveY<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>moveY<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//responder grant의 screen 좌표(아마 움직인 최초 거리를 의미하는듯)</span>\n      <span class=\"token comment\">//x0+dx = movxX인듯 하다.</span>\n      x0<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>x0<span class=\"token punctuation\">,</span>\n      y0<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>y0<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//터치가 시작되고 나서부터의 축적된(움직인) 거리</span>\n      dx<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>dx<span class=\"token punctuation\">,</span>\n      dy<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>dy<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//현재 움직임의 속도</span>\n      <span class=\"token comment\">//정확한 단위는 모르겠지만, 우측/아래로 가면 +(vx/vy가 플러스) 이다,</span>\n      vx<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>vx<span class=\"token punctuation\">,</span>\n      vy<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>vy<span class=\"token punctuation\">,</span>\n      <span class=\"token comment\">//screen에 발행한 터치 수, 세손가락이면 3</span>\n      numberActiveTouches<span class=\"token punctuation\">:</span> gestureState<span class=\"token punctuation\">.</span>numberActiveTouches\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//이동할 값만큼 현재 위치 계산</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_circlesStyles<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>left <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_previousLeft <span class=\"token operator\">+</span> gestureState<span class=\"token punctuation\">.</span>dx<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_circlesStyles<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_previousTop <span class=\"token operator\">+</span> gestureState<span class=\"token punctuation\">.</span>dy<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_updatePosition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function-variable function\">_handlePanResponderEnd</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">,</span> gestureState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'_handlePanResponderEnd'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_unHighlight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_previousLeft <span class=\"token operator\">+=</span> gestureState<span class=\"token punctuation\">.</span>dx<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_previousTop <span class=\"token operator\">+=</span> gestureState<span class=\"token punctuation\">.</span>dy<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> styles <span class=\"token operator\">=</span> StyleSheet<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    flex<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    paddingTop<span class=\"token punctuation\">:</span> <span class=\"token number\">64</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  circle<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    width<span class=\"token punctuation\">:</span> <span class=\"token constant\">CIRCLE_SIZE</span><span class=\"token punctuation\">,</span>\n    height<span class=\"token punctuation\">:</span> <span class=\"token constant\">CIRCLE_SIZE</span><span class=\"token punctuation\">,</span>\n    borderRadius<span class=\"token punctuation\">:</span> <span class=\"token constant\">CIRCLE_SIZE</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token constant\">CIRCLE_COLOR</span><span class=\"token punctuation\">,</span>\n    position<span class=\"token punctuation\">:</span> <span class=\"token string\">'absolute'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TouchGesture<span class=\"token punctuation\">;</span></code></pre></div>\n<h4 id=\"reference\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>reference</h4>\n<ul>\n<li><a href=\"https://facebook.github.io/react-native/docs/panresponder\">https://facebook.github.io/react-native/docs/panresponder</a></li>\n<li>빠른 모바일 앱 개발을 위한 React Native 2e</li>\n</ul>","fields":{"slug":"/posts/rn-PanResponder/","tagSlugs":["/tag/react-native/","/tag/panresponder/"]},"frontmatter":{"date":"2019-06-30T13:42:32.169Z","description":"4장 뒷 부분 PanResponder 파헤치기","tags":["react-native","panresponder"],"title":"[React Native] 4장 모바일 컴포넌트"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/rn-PanResponder/"}}}